Calculation of age distributions
================================

This page presents and overview of how age distributions in Detrital MC are calculated. Distributions of ages from detrital samples can be assembled and visualized in serveral different ways. Below I describe the different distributions and their meanings, as well as how they are used in Detrital MC.

Measured age PDFs and sample age distributions
----------------------------------------------

Measured age PDFs
~~~~~~~~~~~~~~~~~

In order to calculate age distributions for all grain ages in a sample, the first step is to calculate the **probability distribution function** :math:`\mathrm{PDF}(x)` for a single age assuming a normal distribution of error about the mean age :math:`\mu` with the standard deviation :math:`\sigma`, and with a kernel width scaling factor :math:`\alpha`.

.. math::

   \mathrm{PDF}(x) = \frac{1}{\alpha \sigma_{i} \sqrt{2 \pi}} \exp \left(-\frac{1}{2} \left(\frac{x - \mu}{\alpha \sigma} \right)^{2} \right)

The default value for :math:`\alpha` in Detrital MC is 0.6, but this value can be modified as described in Brandon (1996).

Sample age distributions (SPDFs)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Age distributions for measured sample ages can be generated by calculating the sum of the individual measured age PDFs and normalizing that sum to the number of measured ages, 

.. math::

   \mathrm{SPDF}(x) = \frac{1}{n} \sum_{i=1}^{n} \mathrm{PDF}_{i}(x).

This is referred to as the **synoptic probability density function** (SPDF) by Ruhl and Hodges (2005)

Predicted age PDFs and age distributions
----------------------------------------

Predicted age PDFs
~~~~~~~~~~~~~~~~~~

The calculation of individual predicted age PDFs is similar to that above, but the predicted age PDFs are scaled by one or more scaling factors collectively referred to as :math:`f_{\mathrm{eff}}` in order to account for factors that might increase the probability of an age being present in a catchment predicted age distribution, such as differences in the tectonic uplift rate or bedrock mineral fertility.
Thus, the age PDF for a given predicted age can be calculated as

.. math::

   \mathrm{PDF}_{\mathrm{p}}(x) = f_{\mathrm{eff}} \times \mathrm{PDF}(x)

The values for the scaling factors that are combined as :math:`f_{\mathrm{eff}}` are given in the input data file for Detrital MC.
Further detail about this is given in the :doc:`section describing the Detrital MC input file <input-file>`.

Another important difference for the predicted age PDFs is that there are no mean ages or standard deviations for the predicted ages.
Instead, the predicted age is used as the mean age :math:`\mu_{\mathrm{p}}` and the standard deviation :math:`\sigma_{\mathrm{p}}` can be calculated as a function of the uncertainties in the measured ages or a constant percentage of the mean age.
For example, it is often the case that the mean uncertainty fraction in the measured ages is used to calculate the predicted age standard deviations such that the calculated standard deviation would be

.. math::

   \sigma_{\mathrm{p}} = \mu_{\mathrm{p}} \times \sum_{i = 1}^{n} \frac{\sigma_{i}}{\mu_{i}},

where :math:`\sigma_{i}` and :math:`\mu_{i}` are the mean age and standard deviation for the :math:`n` measured ages.

Predicted age distributions (SPDFs)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The predicted age SPDFs are also calculated similar to those for the sample measured ages, but scaled once again by the scaling factor :math:`f_{\mathrm{eff}}`.
In this case, the age distribution should be normalized to have an area of 1.0, so the predicted SPDF is simply the SPDF divided by the average scaling factor :math:`\overline{f_{\mathrm{eff}}}`.
In other words, 

.. math::

   \mathrm{SPDF}_{\mathrm{p}}(x) = \frac{1}{\overline{f_{\mathrm{eff}}}} \times \mathrm{SPDF}(x).

Catchment cumulative distributions
----------------------------------

In order to compare the measured and predicted age distributions, both need to be converted to **cumulative density functions** (CDFs) of some form.
There are two options for this in Detrital MC, described below.

Smoothed distributions
~~~~~~~~~~~~~~~~~~~~~~

The standard CDF used in Detrital MC is simply an integrated version of the SPDF, integrated using the trapezoid rule.
This produces a smooth CDF, since the ages in the SPDF have been smoothed by their measurement uncertainties.

Unsmoothed distributions
~~~~~~~~~~~~~~~~~~~~~~~~

Option two is to calculate an unsmoothed cumulative distribution function.
This function is referred to as the **empirical cumulative distribution function** (ECDF), which is the same as the cumulative age distribution described by Vermeesch (2007).
The result is a step function, where the function value increases by :math:`1/n` for each age in the sorted distribution.

References
----------

Brandon, M. T. (1996). Probability density plot for fission-track grain-age samples. Radiation Measurements, 26(5), 663--676.

Ruhl, K. W., & Hodges, K. V. (2005). The use of detrital mineral cooling ages to evaluate steady state assumptions in active orogens; an example from the central Nepalese Himalaya. Tectonics, 24, no.4, 14.

Vermeesch, P. (2007). Quantitative geomorphology of the White Mountains (California) using detrital apatite fission track thermochronology. Journal of Geophysical Research, F, Earth Surface, 112(F3), F03004.